<app-panel-page-header
  (addButtonClick)="openUserForm()"
  [showAddButton]="canCreateUsers()"
  addButtonLabel="users.addButton"
  title="users.title"
/>

<app-users-table
  [users]="paginatedUsers.items()"
  [paginator]="true"
  [totalCount]="paginatedUsers.totalCount()"
  [lazy]="true"
  (lazyLoad)="onLazyLoad($event)"
  [canAssignRoles]="canAssignRoles()"
  [actionsColumnTemplate]="actionsColumnTemplate"
/>

<ng-template #actionsColumnTemplate let-user>
  <div class="flex items-center gap-2">
    <p-button
      (onClick)="openUserForm(user)"
      icon="pi pi-pencil"
      text
      rounded
      [pTooltip]="'users.form.editUser' | translate"
      [disabled]="!canUpdateUsers()"
    />
    <p-button
      (onClick)="openPersonForm(user, user.person)"
      icon="pi pi-user-edit"
      text
      rounded
      [pTooltip]="'people.form.editPerson' | translate"
      [disabled]="!canUpdateUsers()"
    />
    @if (user.isActive) {
    <p-button
      (onClick)="deactivateUser(user)"
      icon="pi pi-ban"
      text
      rounded
      [disabled]="!canUpdateUsers()"
      severity="danger"
      [pTooltip]="'users.form.deactivateUser' | translate"
    />
    } @else {
    <p-button
      (onClick)="activateUser(user)"
      icon="pi pi-check"
      text
      rounded
      [disabled]="!canUpdateUsers()"
      [pTooltip]="'users.form.activateUser' | translate"
    />
    }
  </div>
</ng-template>

<p-confirmDialog />
