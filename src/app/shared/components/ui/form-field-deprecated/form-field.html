<div
  class="form-field relative"
  [ngClass]="class()"
  [class.inline-editable]="inlineEditable"
  [class.fixed-height]="fixedHeight"
  [class.has-error]="hasError()"
  [class.has-hint]="showHint()"
  [style.height]="fixedHeight ? minHeight : 'auto'"
>
  <!-- Label -->
  @if (label) {
  <span class="text-sm font-medium mb-2 block">
    <ng-content select="app-label"></ng-content>
    @if (isRequired() && !hideRequiredMarker) {
    <span class="text-red-500 ml-1" aria-label="Required">*</span>
    }
  </span>
  }

  <!-- Input Container -->
  <div class="input-container w-full">
    @if (inlineEditable) {
    <p-input-group>
      <ng-container *ngTemplateOutlet="formFieldControl"></ng-container>
      @if (!isEditing()) {
      <p-inputgroup-addon>
        <p-button
          text
          icon="pi pi-pencil"
          [pTooltip]="'common.edit' | translate"
          (click)="onEditClick()"
        />
      </p-inputgroup-addon>
      } @if (isEditing()) {
      <p-inputgroup-addon>
        <p-button
          text
          icon="pi pi-times"
          severity="secondary"
          [pTooltip]="'common.cancel' | translate"
          (click)="onCancelClick()"
        />
      </p-inputgroup-addon>
      <p-inputgroup-addon>
        <p-button
          text
          icon="pi pi-save"
          [pTooltip]="'common.save' | translate"
          (click)="onSaveClick()"
        />
      </p-inputgroup-addon>
      }
    </p-input-group>
    } @else {
    <ng-container *ngTemplateOutlet="formFieldControl"></ng-container>
    }
  </div>

  <!-- Message Container with Fixed Height -->
  <div class="message-container" *ngIf="fixedHeight">
    <!-- Helper Text (shows when no error and conditions are met) -->
    @if (showHint() && !showError()) {
    <div class="hint-text">
      <ng-content select="app-hint"></ng-content>
    </div>
    }

    <!-- Error Message (shows when there's an error and app-control-error is present) -->
    @if (showError()) {
    <!-- <ng-content select="app-control-error"></ng-content> -->

    <!-- <div class="error-text" role="alert" [attr.aria-live]="'polite'"> -->
    <!-- <ng-content select="app-control-error"></ng-content> -->
    <!-- </div> -->
    }
  </div>

  <!-- Messages without Fixed Height -->
  @if (!fixedHeight) {
  <!-- Helper Text -->
  @if (showHint() && !showError()) {
  <div class="hint-text mt-1">
    <ng-content select="app-hint"></ng-content>
  </div>
  }

  <!-- Error Message -->
  @if (showError()) {
  <div class="error-text mt-1" role="alert" [attr.aria-live]="'polite'">
    <ng-content select="app-control-error"></ng-content>
  </div>
  } }
</div>

<ng-template #formFieldControl>
  <!-- Custom Inputs -->
  <ng-content select="app-phone-input"></ng-content>

  <!-- PrimeNG Inputs -->
  <ng-content select="[pTextarea]"></ng-content>
  <ng-content select="[pInputText]"></ng-content>
  <ng-content select="p-autocomplete"></ng-content>
  <ng-content select="p-calendar"></ng-content>
  <ng-content select="p-checkbox"></ng-content>
  <ng-content select="p-colorPicker"></ng-content>
  <ng-content select="p-dropdown"></ng-content>
  <ng-content select="p-inputNumber"></ng-content>
  <ng-content select="p-password"></ng-content>
  <ng-content select="p-radioButton"></ng-content>
  <ng-content select="p-rating"></ng-content>
  <ng-content select="p-slider"></ng-content>
  <ng-content select="p-spinner"></ng-content>
  <ng-content select="p-toggleButton"></ng-content>
  <ng-content select="p-treeSelect"></ng-content>
  <ng-content select="p-tree"></ng-content>
  <ng-content select="p-treeTable"></ng-content>
  <ng-content select="p-treeTable"></ng-content>
  <ng-content select="p-select"></ng-content>
  <ng-content select="p-input-group"></ng-content>
  <ng-content select="p-inputGroup"></ng-content>
  <ng-content select="p-inputgroup"></ng-content>
</ng-template>
